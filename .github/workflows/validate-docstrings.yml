name: Docstring Validation
on: [push, pull_request]
jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      
      - name: Install dependencies
        run: |
          pip install pydocstyle astor tomli  # tomli for Python <3.11 config loading
      
      - name: Create perfect user code file
        run: |
          cat > user_code.py << 'EOF'
          def calculate_total(items):
              """Calculate total price.
              
              Args:
                  items (list): List of numeric values.
              
              Returns:
                  float: Sum of all items.
              """
              return sum(items)
          EOF
      
      - name: Run validation on WELL-DOCUMENTED user code
        run: python docugenius_cli.py user_code.py --min-coverage 90 --min-compliance 85
        # This WILL PASS because user_code.py meets all standards
      
      - name: Create poorly documented file (demonstration only)
        run: echo "def bad(x): return x*2" > bad_code.py
      
      - name: Demonstrate enforcement (expected failure)
        run: python docugenius_cli.py bad_code.py --min-coverage 90 --min-compliance 85 || true
        # This WILL FAIL intentionally to show enforcement works